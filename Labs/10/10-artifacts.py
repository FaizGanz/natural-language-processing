{"cells":[{"cell_type":"markdown","metadata":{"id":"vV6jtqEYgQs8"},"source":["# NLP with Representation Learning: Artifacts in Large LMs\n","\n","*Will Merrill, Nov 14 2022*\n","\n","In this lab, we will:\n","* Identify artifacts (shortcuts) learned by finetuned language models\n","* Get some hands-on experience using the HuggingFace `datasets` library"]},{"cell_type":"markdown","metadata":{"id":"h_okWWLRgcfE"},"source":["-----------------------------------\n","\n","## Setup"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":27124,"status":"ok","timestamp":1668462807839,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"LZxsGu47gM7a","outputId":"691a6c53-bb49-4ac8-bd26-216890a2d26c"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.24.0-py3-none-any.whl (5.5 MB)\n","\u001b[K     |████████████████████████████████| 5.5 MB 36.6 MB/s \n","\u001b[?25hCollecting tokenizers!=0.11.3,<0.14,>=0.11.1\n","  Downloading tokenizers-0.13.2-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.6 MB)\n","\u001b[K     |████████████████████████████████| 7.6 MB 57.7 MB/s \n","\u001b[?25hRequirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.13.0)\n","Collecting huggingface-hub<1.0,>=0.10.0\n","  Downloading huggingface_hub-0.10.1-py3-none-any.whl (163 kB)\n","\u001b[K     |████████████████████████████████| 163 kB 56.4 MB/s \n","\u001b[?25hRequirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2022.6.2)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.8.0)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.10.0->transformers) (4.1.1)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.9)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.10.0)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2022.9.24)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.10.1 tokenizers-0.13.2 transformers-4.24.0\n","Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.6.1-py3-none-any.whl (441 kB)\n","\u001b[K     |████████████████████████████████| 441 kB 27.8 MB/s \n","\u001b[?25hRequirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from datasets) (6.0)\n","Collecting responses<0.19\n","  Downloading responses-0.18.0-py3-none-any.whl (38 kB)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.7/dist-packages (from datasets) (3.8.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (2.23.0)\n","Collecting multiprocess\n","  Downloading multiprocess-0.70.14-py37-none-any.whl (115 kB)\n","\u001b[K     |████████████████████████████████| 115 kB 62.6 MB/s \n","\u001b[?25hCollecting dill<0.3.6\n","  Downloading dill-0.3.5.1-py2.py3-none-any.whl (95 kB)\n","\u001b[K     |████████████████████████████████| 95 kB 1.7 MB/s \n","\u001b[?25hRequirement already satisfied: pyarrow>=6.0.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (6.0.1)\n","Requirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.7/dist-packages (from datasets) (2022.10.0)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from datasets) (1.3.5)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.7/dist-packages (from datasets) (4.64.1)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from datasets) (21.3)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from datasets) (4.13.0)\n","Requirement already satisfied: huggingface-hub<1.0.0,>=0.2.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (0.10.1)\n","Collecting xxhash\n","  Downloading xxhash-3.1.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[K     |████████████████████████████████| 212 kB 59.6 MB/s \n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from datasets) (1.21.6)\n","Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (4.0.2)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (6.0.2)\n","Requirement already satisfied: asynctest==0.13.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (0.13.0)\n","Requirement already satisfied: typing-extensions>=3.7.4 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (4.1.1)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (22.1.0)\n","Requirement already satisfied: charset-normalizer<3.0,>=2.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (2.1.1)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (1.8.1)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (1.3.1)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (1.3.3)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.2.0->datasets) (3.8.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->datasets) (3.0.9)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (1.24.3)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2022.9.24)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2.10)\n","Collecting urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1\n","  Downloading urllib3-1.25.11-py2.py3-none-any.whl (127 kB)\n","\u001b[K     |████████████████████████████████| 127 kB 58.7 MB/s \n","\u001b[?25hRequirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->datasets) (3.10.0)\n","Collecting multiprocess\n","  Downloading multiprocess-0.70.13-py37-none-any.whl (115 kB)\n","\u001b[K     |████████████████████████████████| 115 kB 68.3 MB/s \n","\u001b[?25hRequirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2022.6)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil>=2.7.3->pandas->datasets) (1.15.0)\n","Installing collected packages: urllib3, dill, xxhash, responses, multiprocess, datasets\n","  Attempting uninstall: urllib3\n","    Found existing installation: urllib3 1.24.3\n","    Uninstalling urllib3-1.24.3:\n","      Successfully uninstalled urllib3-1.24.3\n","  Attempting uninstall: dill\n","    Found existing installation: dill 0.3.6\n","    Uninstalling dill-0.3.6:\n","      Successfully uninstalled dill-0.3.6\n","Successfully installed datasets-2.6.1 dill-0.3.5.1 multiprocess-0.70.13 responses-0.18.0 urllib3-1.25.11 xxhash-3.1.0\n"]}],"source":["!pip install transformers\n","!pip install datasets"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":6630,"status":"ok","timestamp":1668462819754,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"5Ia4FpTYf1PL"},"outputs":[],"source":["from transformers import DistilBertTokenizer, DistilBertModel\n","from datasets import load_dataset"]},{"cell_type":"code","execution_count":3,"metadata":{"executionInfo":{"elapsed":296,"status":"ok","timestamp":1668462822219,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"du5z5PFjjTes"},"outputs":[],"source":["from tqdm import tqdm\n","\n","import torch\n","from torch.utils.data import DataLoader\n","import torch.nn as nn"]},{"cell_type":"code","source":["torch.cuda.is_available()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LOKsDC37IcHf","executionInfo":{"status":"ok","timestamp":1668462825505,"user_tz":300,"elapsed":3,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"f98752a3-c3ea-4489-8dd7-bf54d9c8fd1d"},"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":4}]},{"cell_type":"markdown","metadata":{"id":"Sx4hQMXghFgR"},"source":["## Loading Datasets with HuggingFace\n","\n","We'll now see how easy it is to load datasets with the HuggingFace library.\n","\n","In this lab, we'll work with two Natural Language Inference (NLI) datasets: SNLI and MNLI."]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":328,"referenced_widgets":["e7d6e905063147ab8de105995368cc19","602e4ab5458c417f9cdaa05e082e49d7","9a1ae7c4369440f9ad70be63b788415a","bc7742f3b2d84463b45c439578f35122","c819dada8e514e6186669f14cf8d2b7c","9eb71cfc7b8b4795a08dd328c9b54aa8","08478f78fce9431fb3459fc57e8b97d9","7f639d82461d4033ad7b23811c076fd6","90b5a102c8694c358b9285eb1704d545","ad88aab416ad40fa9b79501bbab7e5fc","2f276a57aede4b60b5b1f14180d85bd3","627a00139c434ccab765feff64e0b2fd","4496f75fd5794d9c966b41a85b00afc5","b1973b69f2b542fa97a06d9f535ed49d","87a969f0153d44bcb36ce4d59094da30","874bffa442574437994e02f71d2ad1d6","0825d735c71f438ab073080a5148eba0","5f3b383a93a84ba399ed7969c646b0f2","9fc24641355d4ec88f637a4f3787a99e","67198cd6cf1e4f93ab7daae8c98d4588","2fb4b45d8eb8475aa3fe9868a6a98137","606f81a5a10a43f39f3e313c4bd0a966","d0710188920e422f84db1b84b5150aa9","0685dd5c76564aca8f57b38164784771","8419867136d049789d65469a631ae2e5","29674be589b94940853b25ba414116a4","79e813ed753049f49b14882b9756a959","fa525f165a0341fcbef128dbb5759204","18233adbc9b146b6808c2eadb76d37c0","69a7b7e0ea314ec9aa99a86fc41185e2","b6b4978bb285418facf09bca38b822a9","a03c239db305429fb8d25bfbf28718ec","e317954cd3b24dcca331378e1896eaaf","cbe0dd09aff04de28e41fbae0a8d825f","6e5ddcfebb4348b3ad4f070d1da40e68","cbbaedc03c94411190a7f749df4809dd","34d0f29afb7b49d799d1efe5ef0cd9e0","2dbcb70a5a9b44d7bb4cdf437455187d","26f8dae7994f48d4a8bd87ba2121d2db","cf047eef42644c7da4f0300a653511b1","8c6550a2c68a4b129d2c5029c4429a30","af22e92f45864b088eeda5190e488cf0","1bbd96b04a56492d823dde67e867f63d","6c9b19cc0bfa4355acdd45075376387f","7058fe744d6a4dfc9e8a84281c46db69","2bb0c0e16c754c6bb7b01117431bf81f","afd14df3f27c40bd8a61779c3a3b190f","b1f344b4ae3f48e1b0bd20cdf467daf4","91e36393b88a47caa70a886c8a6d5a4f","34f514250f34474c97e0d226fcec9d5c","e36fb8977b9d41f995955a5846400a41","0cf9d07899394c76a54f0c747e7c7ea5","8fa19acaaa3c42638f19a87ad90d8df2","1e065652779e43c683ffddcf6aa1d46d","779acdeca00e441182e73d88e77a8e76","137c5d836c95443f80ec5c61d63bc9bf","498418489f0b4d20981e57db0d499e8f","4e016f232d3e4a90ac43102d383c565d","f758ecafa39740d1a7d09421e3e1b29a","768b0123b43d4a91b65c0bec82cd0ee5","28a99bcb17fc44b1a19d7f1f10f33b04","e48b302d5c3b41f6ba3c3e2eed67b8a2","a5ed5533b64848f590860c4a23c45d72","2572b42a0f9546aa9026fccfad3dc5e2","af706bc0fde54ed9ae91edb1459fd92b","788a447afa8048c7a80c852e8128648a","bab8d47cbb3a4c1d96290e2ca3ed1af2","0db124207598418a99894647fc8cfda2","f3548b0dbaad41d797fb3e43ab95ab18","1234ae1fc2984796b1105b7356007c91","c9367b9997454afd87eb7ebcdcac7217","2ba2ab735e4544a0b2ee1f05f26ce006","411f0863065b4f53a54595fbef9dfba2","1bf9b63540fd444ba7d5937e672159da","f40801fcaefd4a3881f518195ae7a19c","ca72e87db3e54bd9b73e1879628bd8e0","ae05f174c13e4ffeb200a6394301a016","949459b7558d485eb0a438b68343270b","6cd109a57bc14f2e98149ab611082e75","7e20909993964beab973beceef8ccfa1","b5e25ebe26bc46609923021db0719c0b","58bb420f8ece412e9816eacfcae1f547","14e593a62d164a50b46629e40f21a414","4d7e56abaec74acfabb170ef17dfefa0","6c0528a25967427c86767a59e4fa8d5f","9aaeee00ed2f463abb61f85e246bef9f","cfc170529cac4d889ca55537b5044fa9","e0c0d580a457439089f3b7f4e9952950"]},"executionInfo":{"elapsed":21989,"status":"ok","timestamp":1668463056156,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"rEhbg8pOhI6Z","outputId":"9700aee3-b326-44d5-9309-8d8629be347e"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading builder script:   0%|          | 0.00/3.82k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e7d6e905063147ab8de105995368cc19"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading metadata:   0%|          | 0.00/1.90k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"627a00139c434ccab765feff64e0b2fd"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading readme:   0%|          | 0.00/14.1k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d0710188920e422f84db1b84b5150aa9"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Downloading and preparing dataset snli/plain_text to /root/.cache/huggingface/datasets/snli/plain_text/1.0.0/1f60b67533b65ae0275561ff7828aad5ee4282d0e6f844fd148d05d3c6ea251b...\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/1.93k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"cbe0dd09aff04de28e41fbae0a8d825f"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/1.26M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7058fe744d6a4dfc9e8a84281c46db69"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/65.9M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"137c5d836c95443f80ec5c61d63bc9bf"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/1.26M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"bab8d47cbb3a4c1d96290e2ca3ed1af2"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Dataset snli downloaded and prepared to /root/.cache/huggingface/datasets/snli/plain_text/1.0.0/1f60b67533b65ae0275561ff7828aad5ee4282d0e6f844fd148d05d3c6ea251b. Subsequent calls will reuse this data.\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/3 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"949459b7558d485eb0a438b68343270b"}},"metadata":{}}],"source":["snli = load_dataset(\"snli\")\n","# mnli = load_dataset(\"multi_nli\")"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":320,"status":"ok","timestamp":1668463062808,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"YTLvJ-FrhyDT","outputId":"4ef3870e-b533-4f9b-9de4-9d532686940c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    test: Dataset({\n","        features: ['premise', 'hypothesis', 'label'],\n","        num_rows: 10000\n","    })\n","    train: Dataset({\n","        features: ['premise', 'hypothesis', 'label'],\n","        num_rows: 550152\n","    })\n","    validation: Dataset({\n","        features: ['premise', 'hypothesis', 'label'],\n","        num_rows: 10000\n","    })\n","})"]},"metadata":{},"execution_count":6}],"source":["snli"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"fcLyTKW2h0Qc"},"outputs":[],"source":["# mnli"]},{"cell_type":"markdown","metadata":{"id":"O-n5RxM4i7F6"},"source":["These objects are `DatasetDict`, representing a train/test/validation split for a dataset. Each entry in the dictionary is a `Dataset`.\n","\n","`Dataset`s can be passed to the PyTorch `DataLoader`:"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1668463149356,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"T42zWSjQjMN8","outputId":"87bcf97b-d39e-4721-fe54-bf852f0b4b8e"},"outputs":[{"output_type":"stream","name":"stdout","text":["premise : ['A person on a horse jumps over a broken down airplane.', 'A person on a horse jumps over a broken down airplane.', 'A person on a horse jumps over a broken down airplane.', 'Children smiling and waving at camera']\n","hypothesis : ['A person is training his horse for a competition.', 'A person is at a diner, ordering an omelette.', 'A person is outdoors, on a horse.', 'They are smiling at their parents']\n","label : tensor([1, 2, 0, 1])\n"]}],"source":["snli_train = DataLoader(snli[\"train\"], batch_size=4)\n","for batch in snli_train:\n","  for key, value in batch.items():\n","    print(key, \":\", value)\n","  break"]},{"cell_type":"markdown","metadata":{"id":"KG_yIHS7kYyO"},"source":["## Models and Finetuning\n","\n","We'll work with DistilBERT here instead of BERT.\n","DistilBERT is a distilled version of BERT, meaning it is a smaller model trained to approximate BERT.\n","\n","Working with a smaller model to prototype is often a good idea because it makes development and debugging faster."]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":217,"referenced_widgets":["bf456cf4973343ffab191a731ee0c5c8","bfd910fa7a154fa0a5d8fb29b68109aa","8f8d08171d054af6aa68701805e39b54","f289d11f96a341a6bdc69ce56b33e3d2","0c51f768701c4d189ca9b60da1298ded","a345238699484b90ac54fd3cebaf3e9b","a3fd7bd087be498d9d5c94f0f1476eb6","b4e094e04d7348fcab0b8d4cc1b78484","b79313c14b90436581c6a5ad0878ed2b","6b115376a60843919ea098fab63aaebb","ecc252b5030040259b7909f74297b002","df64f79946ab449b9618b8954ca7f2a5","96416c064a064e1593c0f4dfafbf3bee","cb7f240641e54d968be2830a921a4bf8","fbde5b5fdd6542449aabeaea8c5d3fc9","91ee86a2447842d8adb7afcbe2b62a01","d8c5f9ce5f2849a5a3658c67681a0b84","bb5d6e7786bc4d7196d53443d8645a5c","aaaea15b520a4c009509ff0d8a748afa","46598f73e0c24516aaeac05862893099","f10b962d23f8400bbfb2d09ea3604421","23e023296dc1409e9b1d6acd468298c5","1d7bea5db7e84a8ba04ade331c2e2401","ba19c947302a43378108268bd4c29931","35f859eaad66428eae2e24cb96ced7d4","2a6856a01f8b4cceaa6c5ab4ffefe823","72a4177be5304b5ba7eaec8d9ef2f6fb","7c908619b17c4ff0b68fb3f9a8b79a99","b23a29a1518840928c29455d282abad3","23dabbb566944341a03a1268a901e5b0","f97ff31cb55d498aaad8c5ded2167c55","4a08de7859e44b5da463ea70e8f7db8f","c731e734451f4b47bd23405dfa4a23a6","d7b102d97a894b9dbe036bca4949a292","37669661554a4a0ca1bafcfef3840c56","e64205ec2ed741ec92040bc47715d29a","2117f4b511e8462d8c8b4ec0718044cd","c093b28357ac4f5997c8a240069541f4","3f6f60d94c2f47c8bd732995430b52a2","945f01a5114f4deebb7cb9d3220a2f7a","6125d2c58b784b39bed36c657674ab3a","a83005ff5c0a4e78a7b0afcf0613733a","0eeaf77ac1604549ac44e74b7981f1c4","bfdad0a750b64189b841f6ae5bc7441b"]},"executionInfo":{"elapsed":15988,"status":"ok","timestamp":1668463345249,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"89mw_zILkmvi","outputId":"2222b204-91ef-4705-e17e-423c5ae92382"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/232k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"bf456cf4973343ffab191a731ee0c5c8"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/28.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"df64f79946ab449b9618b8954ca7f2a5"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/483 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1d7bea5db7e84a8ba04ade331c2e2401"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading:   0%|          | 0.00/268M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d7b102d97a894b9dbe036bca4949a292"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of the model checkpoint at distilbert-base-uncased were not used when initializing DistilBertModel: ['vocab_transform.bias', 'vocab_layer_norm.weight', 'vocab_projector.bias', 'vocab_projector.weight', 'vocab_transform.weight', 'vocab_layer_norm.bias']\n","- This IS expected if you are initializing DistilBertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).\n","- This IS NOT expected if you are initializing DistilBertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n"]}],"source":["tokenizer = DistilBertTokenizer.from_pretrained('distilbert-base-uncased')\n","model = DistilBertModel.from_pretrained(\"distilbert-base-uncased\")"]},{"cell_type":"code","source":["model"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"L_XkcVZIKmB5","executionInfo":{"status":"ok","timestamp":1668463360168,"user_tz":300,"elapsed":2,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"4c61250b-bd83-40dd-fa32-8a695ceba146"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DistilBertModel(\n","  (embeddings): Embeddings(\n","    (word_embeddings): Embedding(30522, 768, padding_idx=0)\n","    (position_embeddings): Embedding(512, 768)\n","    (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","    (dropout): Dropout(p=0.1, inplace=False)\n","  )\n","  (transformer): Transformer(\n","    (layer): ModuleList(\n","      (0): TransformerBlock(\n","        (attention): MultiHeadSelfAttention(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","        )\n","        (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (ffn): FFN(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","          (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","          (activation): GELUActivation()\n","        )\n","        (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (1): TransformerBlock(\n","        (attention): MultiHeadSelfAttention(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","        )\n","        (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (ffn): FFN(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","          (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","          (activation): GELUActivation()\n","        )\n","        (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (2): TransformerBlock(\n","        (attention): MultiHeadSelfAttention(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","        )\n","        (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (ffn): FFN(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","          (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","          (activation): GELUActivation()\n","        )\n","        (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (3): TransformerBlock(\n","        (attention): MultiHeadSelfAttention(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","        )\n","        (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (ffn): FFN(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","          (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","          (activation): GELUActivation()\n","        )\n","        (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (4): TransformerBlock(\n","        (attention): MultiHeadSelfAttention(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","        )\n","        (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (ffn): FFN(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","          (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","          (activation): GELUActivation()\n","        )\n","        (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","      (5): TransformerBlock(\n","        (attention): MultiHeadSelfAttention(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","          (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","        )\n","        (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        (ffn): FFN(\n","          (dropout): Dropout(p=0.1, inplace=False)\n","          (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","          (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","          (activation): GELUActivation()\n","        )\n","        (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      )\n","    )\n","  )\n",")"]},"metadata":{},"execution_count":9}]},{"cell_type":"code","execution_count":10,"metadata":{"executionInfo":{"elapsed":1107,"status":"ok","timestamp":1668463605274,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"wlyhm0Eqmd5M"},"outputs":[],"source":["class FinetuneNliClassifier(nn.Module):\n","\n","  def __init__(self, model, d_hidden, n_classes, mode: str = \"full\"):\n","    super().__init__()\n","    self.model = model\n","    self.project = nn.Linear(d_hidden, n_classes)\n","    self.mode = mode\n","\n","  def forward(self, premise, hypothesis):\n","    prem_hidden_states, = self.model(**premise).values() # [batch_size, seq_len, 768]\n","    prem_state = prem_hidden_states[:, 0, :] # [batch_size, 768]\n","\n","    hypo_hidden_states, = self.model(**hypothesis).values()\n","    hypo_state = hypo_hidden_states[:, 0, :]\n","\n","    if self.mode == \"full\":\n","      cls_state = prem_state + hypo_state\n","    elif self.mode == \"prem_only\":\n","      cls_state = prem_state\n","    elif self.mode == \"hypo_only\":\n","      cls_state = hypo_state\n","    else:\n","      raise ValueError(\"Unknown mode \" + self.mode)\n","\n","    return self.project(cls_state)"]},{"cell_type":"code","execution_count":11,"metadata":{"executionInfo":{"elapsed":308,"status":"ok","timestamp":1668463611250,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"BMs0R-bwnKNX"},"outputs":[],"source":["classifier = FinetuneNliClassifier(model, 768, 3)"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":285,"status":"ok","timestamp":1668463615250,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"CvJ5wsh05fHd","outputId":"31507eae-ef32-42df-bfe8-b05959af79a4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["FinetuneNliClassifier(\n","  (model): DistilBertModel(\n","    (embeddings): Embeddings(\n","      (word_embeddings): Embedding(30522, 768, padding_idx=0)\n","      (position_embeddings): Embedding(512, 768)\n","      (LayerNorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","      (dropout): Dropout(p=0.1, inplace=False)\n","    )\n","    (transformer): Transformer(\n","      (layer): ModuleList(\n","        (0): TransformerBlock(\n","          (attention): MultiHeadSelfAttention(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","          )\n","          (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","          (ffn): FFN(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","            (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","            (activation): GELUActivation()\n","          )\n","          (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        )\n","        (1): TransformerBlock(\n","          (attention): MultiHeadSelfAttention(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","          )\n","          (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","          (ffn): FFN(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","            (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","            (activation): GELUActivation()\n","          )\n","          (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        )\n","        (2): TransformerBlock(\n","          (attention): MultiHeadSelfAttention(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","          )\n","          (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","          (ffn): FFN(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","            (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","            (activation): GELUActivation()\n","          )\n","          (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        )\n","        (3): TransformerBlock(\n","          (attention): MultiHeadSelfAttention(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","          )\n","          (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","          (ffn): FFN(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","            (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","            (activation): GELUActivation()\n","          )\n","          (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        )\n","        (4): TransformerBlock(\n","          (attention): MultiHeadSelfAttention(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","          )\n","          (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","          (ffn): FFN(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","            (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","            (activation): GELUActivation()\n","          )\n","          (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        )\n","        (5): TransformerBlock(\n","          (attention): MultiHeadSelfAttention(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (q_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (k_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (v_lin): Linear(in_features=768, out_features=768, bias=True)\n","            (out_lin): Linear(in_features=768, out_features=768, bias=True)\n","          )\n","          (sa_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","          (ffn): FFN(\n","            (dropout): Dropout(p=0.1, inplace=False)\n","            (lin1): Linear(in_features=768, out_features=3072, bias=True)\n","            (lin2): Linear(in_features=3072, out_features=768, bias=True)\n","            (activation): GELUActivation()\n","          )\n","          (output_layer_norm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)\n","        )\n","      )\n","    )\n","  )\n","  (project): Linear(in_features=768, out_features=3, bias=True)\n",")"]},"metadata":{},"execution_count":12}],"source":["classifier"]},{"cell_type":"markdown","metadata":{"id":"izJhup0ojlA_"},"source":["When you use the tokenizer, be sure to include `padding=True` to handle inputs of different sizes. Compare the cells below:"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"MABxudWDjbXx"},"outputs":[],"source":["# premises = tokenizer([\"Hello Earth\", \"Hello also Mars\"], return_tensors='pt')"]},{"cell_type":"code","execution_count":13,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1668463675964,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"TWeXrieHnWyX","outputId":"b4433f29-3032-4781-9269-39fb6f48e292"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'input_ids': tensor([[ 101, 7592, 3011,  102,    0],\n","        [ 101, 7592, 2036, 7733,  102]]), 'attention_mask': tensor([[1, 1, 1, 1, 0],\n","        [1, 1, 1, 1, 1]])}"]},"metadata":{},"execution_count":13}],"source":["premises = tokenizer([\"Hello Earth\", \"Hello also Mars\"], return_tensors='pt', padding=True)\n","premises"]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":302,"status":"ok","timestamp":1668463717640,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"uDdzPDEBuwVG","outputId":"e9049497-e6a0-433a-82f1-9c550b8fb74d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'input_ids': tensor([[ 101, 1996, 3712, 2003, 2630,  102],\n","        [ 101, 1996, 3712, 2003, 2665,  102]]), 'attention_mask': tensor([[1, 1, 1, 1, 1, 1],\n","        [1, 1, 1, 1, 1, 1]])}"]},"metadata":{},"execution_count":14}],"source":["hypotheses = tokenizer([\"The sky is blue\", \"The sky is green\"], return_tensors=\"pt\", padding=True)\n","hypotheses"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":305,"status":"ok","timestamp":1668463733199,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"rQmBhZC7nsOm","outputId":"658b5355-b31e-4e0e-8691-be4d8d6bf2d4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[-0.3698,  0.7815, -1.1856],\n","        [-0.3786,  0.8477, -1.1117]], grad_fn=<AddmmBackward0>)"]},"metadata":{},"execution_count":15}],"source":["classifier(premises, hypotheses)"]},{"cell_type":"markdown","metadata":{"id":"tvK8FxQbsTgl"},"source":["## Finetuning Loop\n","\n","[SNLI](https://huggingface.co/datasets/snli) contains some examples with a label of `-1`, presumably because they were removed after someone noticed they were incorrect.\n","\n","We account for this by adding `ignore_index=-1` to our loss function."]},{"cell_type":"code","execution_count":16,"metadata":{"executionInfo":{"elapsed":294,"status":"ok","timestamp":1668464067843,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"h2qQ0PCosXDC"},"outputs":[],"source":["def finetune_epoch(clf: FinetuneNliClassifier,\n","                   train_dataset,\n","                   batch_size=128,\n","                   lr=2e-4,\n","                   device=\"cuda:0\"):\n","  clf.train()\n","  loader = DataLoader(train_dataset, batch_size)\n","\n","  params_to_update = []\n","  for name,param in clf.named_parameters():\n","      if param.requires_grad == True:\n","          params_to_update.append(param)\n","\n","  optimizer = torch.optim.Adam(params_to_update, lr=2e-05, eps=1e-08)\n","  criterion = nn.CrossEntropyLoss(ignore_index=-1).to(device)\n","\n","  idx = 0\n","\n","  for batch in tqdm(loader, desc=\"Train\"):\n","    premise = tokenizer(batch[\"premise\"], return_tensors=\"pt\", padding=True).to(device)\n","    hypothesis = tokenizer(batch[\"hypothesis\"], return_tensors=\"pt\", padding=True).to(device)\n","    label = batch[\"label\"].to(device)\n","\n","    # Train loop.\n","    optimizer.zero_grad()\n","    logits = clf(premise, hypothesis)\n","    loss = criterion(logits, label)\n","    loss.backward()\n","    # Have gradients at this point.\n","    nn.utils.clip_grad_norm_(clf.parameters(), max_norm=2.0, norm_type=2)\n","    optimizer.step()\n","\n","    if idx % 100 == 0:\n","      print(loss.item())\n","    idx += 1"]},{"cell_type":"code","execution_count":17,"metadata":{"executionInfo":{"elapsed":1101,"status":"ok","timestamp":1668464072190,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"7FrUfR0PoosH"},"outputs":[],"source":["@torch.no_grad()\n","def evaluate(clf: FinetuneNliClassifier, eval_dataset):\n","  clf.eval()\n","  loader = DataLoader(eval_dataset, batch_size=512)\n","  n_right = 0\n","  n_total = 0\n","  for batch in tqdm(loader, desc=\"Eval\"):\n","    premise = tokenizer(batch[\"premise\"], return_tensors=\"pt\", padding=True).to(device)\n","    hypothesis = tokenizer(batch[\"hypothesis\"], return_tensors=\"pt\", padding=True).to(device)\n","    label = batch[\"label\"].to(device)\n","\n","    # Compute accuracy.\n","    logits = clf(premise, hypothesis)\n","    right = logits.argmax(-1) == label\n","    n_right += right.sum().item()\n","    n_total += right.numel()\n","  print(\"  Acc:\", n_right / n_total)"]},{"cell_type":"code","execution_count":18,"metadata":{"executionInfo":{"elapsed":2,"status":"ok","timestamp":1668464074573,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"-8V1avuVrO3I"},"outputs":[],"source":["def finetune(clf: FinetuneNliClassifier, dataset, n_epochs: int = 1, **args):\n","  print(\"Using device:\", args[\"device\"])\n","  train = dataset[\"train\"]\n","  # train = dataset[\"train\"].select(list(range(100)))\n","  valid = dataset[\"validation\"]\n","  for epoch in range(n_epochs):\n","    print(f\"Starting epoch {epoch}...\")\n","    train = train.shuffle()\n","    finetune_epoch(clf, train, **args)\n","    evaluate(clf, valid)"]},{"cell_type":"markdown","metadata":{"id":"YiZyk4uFedBz"},"source":["## Experiments"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":35},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1668374833299,"user":{"displayName":"William Merrill","userId":"00521682070879348599"},"user_tz":300},"id":"xP_YJTPSkmYt","outputId":"2b029c32-af26-48f2-b1f8-ae99db57e5b8"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["'cuda:0'"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":47}],"source":["device = \"cuda:0\" if torch.cuda.is_available() else \"cpu\"\n","device"]},{"cell_type":"markdown","metadata":{"id":"ninRN853yAVC"},"source":["### Normal Model\n","\n","Let's first train the normal model."]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Sb5VotgdFX3F","executionInfo":{"status":"ok","timestamp":1668378135461,"user_tz":300,"elapsed":3302168,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"cfee50b3-5105-4920-c537-f628a4095b18"},"outputs":[{"output_type":"stream","name":"stdout","text":["Using device: cuda:0\n","Starting epoch 0...\n"]},{"output_type":"stream","name":"stderr","text":["Train:   0%|          | 1/4299 [00:00<57:47,  1.24it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1234, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   2%|▏         | 101/4299 [01:17<51:22,  1.36it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8312, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   5%|▍         | 201/4299 [02:32<54:30,  1.25it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8532, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   7%|▋         | 301/4299 [03:50<48:03,  1.39it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8778, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   9%|▉         | 401/4299 [05:06<48:20,  1.34it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8000, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  12%|█▏        | 501/4299 [06:19<48:22,  1.31it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7376, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  14%|█▍        | 601/4299 [07:36<47:38,  1.29it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7977, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  16%|█▋        | 701/4299 [08:52<53:17,  1.13it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8071, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  19%|█▊        | 801/4299 [10:07<48:55,  1.19it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8783, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  21%|██        | 901/4299 [11:23<40:49,  1.39it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7629, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  23%|██▎       | 1001/4299 [12:40<40:19,  1.36it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8579, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  26%|██▌       | 1101/4299 [13:56<39:34,  1.35it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8225, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  28%|██▊       | 1201/4299 [15:13<37:34,  1.37it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.9151, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  30%|███       | 1301/4299 [16:30<42:48,  1.17it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7676, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  33%|███▎      | 1401/4299 [17:49<39:13,  1.23it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8036, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  35%|███▍      | 1501/4299 [19:05<35:26,  1.32it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7945, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  37%|███▋      | 1601/4299 [20:21<32:16,  1.39it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7853, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  40%|███▉      | 1701/4299 [21:36<37:31,  1.15it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.9557, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  42%|████▏     | 1801/4299 [22:53<31:19,  1.33it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8032, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  44%|████▍     | 1901/4299 [24:11<31:20,  1.27it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8173, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  47%|████▋     | 2001/4299 [25:29<27:59,  1.37it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7584, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  49%|████▉     | 2101/4299 [26:44<30:16,  1.21it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8647, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  51%|█████     | 2201/4299 [28:01<24:45,  1.41it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8532, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  54%|█████▎    | 2301/4299 [29:18<25:56,  1.28it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7299, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  56%|█████▌    | 2401/4299 [30:33<22:49,  1.39it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7842, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  58%|█████▊    | 2501/4299 [31:48<24:14,  1.24it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8793, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  61%|██████    | 2601/4299 [33:04<23:28,  1.21it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8297, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  63%|██████▎   | 2701/4299 [34:20<20:32,  1.30it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8473, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  65%|██████▌   | 2801/4299 [35:34<21:09,  1.18it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7817, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  67%|██████▋   | 2901/4299 [36:54<18:50,  1.24it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7735, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  70%|██████▉   | 3001/4299 [38:10<15:20,  1.41it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7836, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  72%|███████▏  | 3101/4299 [39:23<14:02,  1.42it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7396, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  74%|███████▍  | 3201/4299 [40:38<13:52,  1.32it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.9382, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  77%|███████▋  | 3301/4299 [41:54<13:23,  1.24it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7820, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  79%|███████▉  | 3401/4299 [43:10<11:25,  1.31it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7511, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  81%|████████▏ | 3501/4299 [44:25<10:03,  1.32it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7112, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  84%|████████▍ | 3601/4299 [45:41<08:38,  1.35it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8594, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  86%|████████▌ | 3701/4299 [46:58<08:13,  1.21it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7826, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  88%|████████▊ | 3801/4299 [48:13<06:07,  1.36it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8888, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  91%|█████████ | 3901/4299 [49:32<05:36,  1.18it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7989, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  93%|█████████▎| 4001/4299 [50:47<03:47,  1.31it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6995, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  95%|█████████▌| 4101/4299 [52:02<02:39,  1.24it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7757, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  98%|█████████▊| 4201/4299 [53:19<01:21,  1.21it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8086, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train: 100%|██████████| 4299/4299 [54:32<00:00,  1.31it/s]\n","Eval: 100%|██████████| 20/20 [00:29<00:00,  1.45s/it]"]},{"output_type":"stream","name":"stdout","text":["  Acc: 0.6412\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}],"source":["clf_full = FinetuneNliClassifier(model, 768, 3)\n","clf_full.to(device)\n","finetune(clf_full, snli, device=device)"]},{"cell_type":"markdown","metadata":{"id":"mlxSSR0NyNAF"},"source":["### Ablation: Premise and Hypothesis Only\n","\n","A good NLI model should rely on both the premise and hypothesis to make its prediction. As a sanity check, let's check what happens if we only give the model the premise (or only the hypothesis).\n","\n","We first train a model that only gets the premise."]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CFIqlqG4FByH","executionInfo":{"status":"ok","timestamp":1668380776540,"user_tz":300,"elapsed":2641088,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"cf675473-8030-4fe2-9293-6b5162e4425b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Using device: cuda:0\n","Starting epoch 0...\n"]},{"output_type":"stream","name":"stderr","text":["Train:   0%|          | 1/4299 [00:00<44:38,  1.60it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1070, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   2%|▏         | 101/4299 [01:02<43:39,  1.60it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1020, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   5%|▍         | 201/4299 [02:03<44:47,  1.52it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1062, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   7%|▋         | 301/4299 [03:04<39:23,  1.69it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0969, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   9%|▉         | 401/4299 [04:05<35:26,  1.83it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1011, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  12%|█▏        | 501/4299 [05:05<38:03,  1.66it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0974, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  14%|█▍        | 601/4299 [06:06<44:28,  1.39it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1000, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  16%|█▋        | 701/4299 [07:07<33:48,  1.77it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1027, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  19%|█▊        | 801/4299 [08:08<33:18,  1.75it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1014, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  21%|██        | 901/4299 [09:09<38:16,  1.48it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0994, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  23%|██▎       | 1001/4299 [10:10<32:38,  1.68it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0984, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  26%|██▌       | 1101/4299 [11:09<30:45,  1.73it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0977, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  28%|██▊       | 1201/4299 [12:10<30:14,  1.71it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1011, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  30%|███       | 1301/4299 [13:10<30:55,  1.62it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1021, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  33%|███▎      | 1401/4299 [14:13<30:18,  1.59it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0995, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  35%|███▍      | 1501/4299 [15:14<31:31,  1.48it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1039, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  37%|███▋      | 1601/4299 [16:14<26:25,  1.70it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0984, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  40%|███▉      | 1701/4299 [17:15<26:54,  1.61it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0963, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  42%|████▏     | 1801/4299 [18:15<24:40,  1.69it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1046, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  44%|████▍     | 1901/4299 [19:18<26:26,  1.51it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0999, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  47%|████▋     | 2001/4299 [20:19<24:41,  1.55it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0951, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  49%|████▉     | 2101/4299 [21:20<22:42,  1.61it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1094, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  51%|█████     | 2201/4299 [22:20<20:11,  1.73it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0983, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  54%|█████▎    | 2301/4299 [23:20<19:46,  1.68it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1016, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  56%|█████▌    | 2401/4299 [24:22<19:00,  1.66it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0982, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  58%|█████▊    | 2501/4299 [25:22<19:10,  1.56it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1013, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  61%|██████    | 2601/4299 [26:21<16:47,  1.69it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1021, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  63%|██████▎   | 2701/4299 [27:22<15:16,  1.74it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0954, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  65%|██████▌   | 2801/4299 [28:22<15:32,  1.61it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0977, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  67%|██████▋   | 2901/4299 [29:24<13:33,  1.72it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1054, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  70%|██████▉   | 3001/4299 [30:25<13:03,  1.66it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1038, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  72%|███████▏  | 3101/4299 [31:26<12:00,  1.66it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1066, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  74%|███████▍  | 3201/4299 [32:26<10:05,  1.81it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0989, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  77%|███████▋  | 3301/4299 [33:27<11:15,  1.48it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0973, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  79%|███████▉  | 3401/4299 [34:27<10:22,  1.44it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0999, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  81%|████████▏ | 3501/4299 [35:28<08:03,  1.65it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1049, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  84%|████████▍ | 3601/4299 [36:29<06:47,  1.71it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0965, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  86%|████████▌ | 3701/4299 [37:29<06:12,  1.61it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0993, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  88%|████████▊ | 3801/4299 [38:30<05:06,  1.62it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1004, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  91%|█████████ | 3901/4299 [39:30<03:56,  1.68it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1003, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  93%|█████████▎| 4001/4299 [40:31<02:50,  1.75it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1011, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  95%|█████████▌| 4101/4299 [41:31<01:55,  1.71it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.1013, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  98%|█████████▊| 4201/4299 [42:32<00:57,  1.71it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0955, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train: 100%|██████████| 4299/4299 [43:31<00:00,  1.65it/s]\n","Eval: 100%|██████████| 20/20 [00:29<00:00,  1.45s/it]"]},{"output_type":"stream","name":"stdout","text":["  Acc: 0.3329\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}],"source":["clf_prem = FinetuneNliClassifier(model, 768, 3, mode=\"prem_only\")\n","clf_prem.to(device)\n","finetune(clf_prem, snli, device=device)"]},{"cell_type":"markdown","metadata":{"id":"D5HO2yvtFHhG"},"source":["Finally, we train a model that only gets a hypothesis."]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"H5PQhAIZFbH9","executionInfo":{"status":"ok","timestamp":1668382945453,"user_tz":300,"elapsed":2168932,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"9c50fe52-f5b0-4cf4-901e-349d718dece6"},"outputs":[{"output_type":"stream","name":"stdout","text":["Using device: cuda:0\n","Starting epoch 0...\n"]},{"output_type":"stream","name":"stderr","text":["Train:   0%|          | 1/4299 [00:00<35:56,  1.99it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(1.0658, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   2%|▏         | 101/4299 [00:50<39:25,  1.77it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6579, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   5%|▍         | 201/4299 [01:39<34:48,  1.96it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7881, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   7%|▋         | 301/4299 [02:29<33:37,  1.98it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8136, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:   9%|▉         | 401/4299 [03:19<33:14,  1.95it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6610, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  12%|█▏        | 501/4299 [04:08<29:32,  2.14it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7841, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  14%|█▍        | 601/4299 [04:59<32:39,  1.89it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7446, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  16%|█▋        | 701/4299 [05:49<31:25,  1.91it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7420, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  19%|█▊        | 801/4299 [06:39<30:55,  1.89it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7460, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  21%|██        | 901/4299 [07:30<27:39,  2.05it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6758, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  23%|██▎       | 1001/4299 [08:21<28:03,  1.96it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6706, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  26%|██▌       | 1101/4299 [09:11<25:34,  2.08it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7354, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  28%|██▊       | 1201/4299 [10:00<25:59,  1.99it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7141, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  30%|███       | 1301/4299 [10:52<29:51,  1.67it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7776, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  33%|███▎      | 1401/4299 [11:41<22:31,  2.14it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7197, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  35%|███▍      | 1501/4299 [12:30<23:34,  1.98it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6953, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  37%|███▋      | 1601/4299 [13:19<21:15,  2.12it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6992, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  40%|███▉      | 1701/4299 [14:08<22:33,  1.92it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6806, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  42%|████▏     | 1801/4299 [14:57<21:46,  1.91it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6942, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  44%|████▍     | 1901/4299 [15:47<19:33,  2.04it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6597, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  47%|████▋     | 2001/4299 [16:37<17:23,  2.20it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6423, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  49%|████▉     | 2101/4299 [17:28<17:53,  2.05it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7241, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  51%|█████     | 2201/4299 [18:18<16:50,  2.08it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7647, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  54%|█████▎    | 2301/4299 [19:08<16:20,  2.04it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7455, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  56%|█████▌    | 2401/4299 [19:57<15:05,  2.10it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7415, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  58%|█████▊    | 2501/4299 [20:46<14:23,  2.08it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6549, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  61%|██████    | 2601/4299 [21:37<15:59,  1.77it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6580, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  63%|██████▎   | 2701/4299 [22:26<12:15,  2.17it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7244, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  65%|██████▌   | 2801/4299 [23:16<12:28,  2.00it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.8207, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  67%|██████▋   | 2901/4299 [24:06<11:18,  2.06it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7202, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  70%|██████▉   | 3001/4299 [24:56<10:14,  2.11it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7182, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  72%|███████▏  | 3101/4299 [25:45<09:27,  2.11it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6348, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  74%|███████▍  | 3201/4299 [26:35<09:22,  1.95it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7353, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  77%|███████▋  | 3301/4299 [27:24<07:58,  2.09it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6768, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  79%|███████▉  | 3401/4299 [28:13<07:05,  2.11it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7627, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  81%|████████▏ | 3501/4299 [29:03<06:50,  1.95it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6287, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  84%|████████▍ | 3601/4299 [29:51<05:51,  1.99it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7275, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  86%|████████▌ | 3701/4299 [30:41<04:49,  2.06it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7103, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  88%|████████▊ | 3801/4299 [31:31<03:53,  2.13it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.7138, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  91%|█████████ | 3901/4299 [32:22<03:22,  1.96it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6837, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  93%|█████████▎| 4001/4299 [33:12<02:17,  2.16it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6956, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  95%|█████████▌| 4101/4299 [34:03<01:48,  1.82it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6829, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train:  98%|█████████▊| 4201/4299 [34:51<00:49,  1.99it/s]"]},{"output_type":"stream","name":"stdout","text":["tensor(0.6962, device='cuda:0', grad_fn=<NllLossBackward0>)\n"]},{"output_type":"stream","name":"stderr","text":["Train: 100%|██████████| 4299/4299 [35:39<00:00,  2.01it/s]\n","Eval: 100%|██████████| 20/20 [00:29<00:00,  1.45s/it]"]},{"output_type":"stream","name":"stdout","text":["  Acc: 0.6852\n"]},{"output_type":"stream","name":"stderr","text":["\n"]}],"source":["clf_hypo = FinetuneNliClassifier(model, 768, 3, mode=\"hypo_only\")\n","clf_hypo.to(device)\n","finetune(clf_hypo, snli, device=device)"]},{"cell_type":"markdown","metadata":{"id":"LWTgorMxFrGx"},"source":["### Another Heuristic: Lexical Overlap\n","\n","Heuristic rule: if every token in the hypothesis occurs in the premise, predict entailment.\n","\n","**Example #1: Heuristic Correct**\n","* Premise: \"I like cats and dogs\"\n","* Hypothesis: \"I like cats\"\n","\n","**Example #2: Heuristic Incorrect**\n","* Premise: \"I like cats or dogs, but not both\"\n","* Hypothesis: \"I like cats\"\n","\n","**Exercise:** What percent of the time should the lexical overlap heuristic work?"]},{"cell_type":"code","source":["!pip install nltk"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"6ER4imsk4tZV","executionInfo":{"status":"ok","timestamp":1668464515444,"user_tz":300,"elapsed":3156,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"32447d91-7213-445b-b53e-8f273c1f94ed"},"execution_count":19,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: nltk in /usr/local/lib/python3.7/dist-packages (3.7)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from nltk) (4.64.1)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from nltk) (7.1.2)\n","Requirement already satisfied: regex>=2021.8.3 in /usr/local/lib/python3.7/dist-packages (from nltk) (2022.6.2)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from nltk) (1.2.0)\n"]}]},{"cell_type":"code","source":["import nltk\n","from nltk.tokenize import word_tokenize"],"metadata":{"id":"BRKU5kVa4stM","executionInfo":{"status":"ok","timestamp":1668464518772,"user_tz":300,"elapsed":312,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","source":["nltk.download(\"punkt\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0m6LWEFJ47c6","executionInfo":{"status":"ok","timestamp":1668464522589,"user_tz":300,"elapsed":987,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"67332bd9-06a8-4ddf-8071-6a64b58b3a1c"},"execution_count":21,"outputs":[{"output_type":"stream","name":"stderr","text":["[nltk_data] Downloading package punkt to /root/nltk_data...\n","[nltk_data]   Unzipping tokenizers/punkt.zip.\n"]},{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{},"execution_count":21}]},{"cell_type":"code","source":["ENTAILS = 0"],"metadata":{"id":"gn0kLB0y2A43","executionInfo":{"status":"ok","timestamp":1668464720081,"user_tz":300,"elapsed":288,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}}},"execution_count":24,"outputs":[]},{"cell_type":"code","source":["STOP = \"th\"\n","\n","def overlaps(example):\n","  premise = word_tokenize(example[\"premise\"])\n","  hypothesis = word_tokenize(example[\"hypothesis\"])\n","  for word in hypothesis:\n","    if word not in premise:\n","      return False\n","  return True"],"metadata":{"id":"2kQtHia13tuq","executionInfo":{"status":"ok","timestamp":1668464705708,"user_tz":300,"elapsed":420,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}}},"execution_count":22,"outputs":[]},{"cell_type":"code","source":["valid = snli[\"validation\"]\n","valid = [ex for ex in valid if overlaps(ex)]\n","acc = sum(int(ex[\"label\"] == ENTAILS) for ex in valid) / len(valid)\n","print(\"Heuristic acc\", acc)"],"metadata":{"id":"psvis-WfL9SR","executionInfo":{"status":"ok","timestamp":1668464727064,"user_tz":300,"elapsed":5091,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"1ce4bb4b-9d98-450a-a412-f0fafe422820"},"execution_count":25,"outputs":[{"output_type":"stream","name":"stdout","text":["Heuristic acc 0.9678714859437751\n"]}]},{"cell_type":"markdown","source":["What about with newer NLI datasets designed to remove artifacts? Let's check MNLI."],"metadata":{"id":"QSpMxtIYulRd"}},{"cell_type":"code","source":["mnli = load_dataset(\"multi_nli\")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":66,"referenced_widgets":["09a3e6f1da3a4786b2b8cc798b2afd8b","9cb83ad0995c4cebadc30eec4f224d5b","fa8903919678492a944a96c613fb024c","12454eee837b4395ac2bee2a5f5d17d4","67130e527da9476db7621ec613ff29e7","d392d54bcd91479dab8d99bcde9332ee","7539bc8b37be43068307a2cd066bc1c5","56cf01c787fa4fbeac1afd33186dd657","7d134b767ffa44e2b286f99a3206757c","3a7ea45e85d14139998e832036a0073e","0c5ba4eda7834fc5b8e16deaa3ff40d5"]},"id":"xRobb946vkHr","executionInfo":{"status":"ok","timestamp":1668391475920,"user_tz":300,"elapsed":4726,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"9c4bba8e-f79b-4d46-d6ce-e9b3a7cf59a2"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:datasets.builder:Found cached dataset multi_nli (/root/.cache/huggingface/datasets/multi_nli/default/0.0.0/591f72eb6263d1ab527561777936b199b714cda156d35716881158a2bd144f39)\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/3 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"09a3e6f1da3a4786b2b8cc798b2afd8b"}},"metadata":{}}]},{"cell_type":"code","source":["valid = mnli[\"validation_matched\"]\n","valid = [ex for ex in valid if overlaps(ex)]\n","acc = sum(int(ex[\"label\"] == ENTAILS) for ex in valid) / len(valid)\n","print(\"Heuristic acc\", acc)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"zq1wufSgv-_k","executionInfo":{"status":"ok","timestamp":1668391765820,"user_tz":300,"elapsed":9659,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"dff67016-f261-4ab2-a200-5b1aa29030ee"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Heuristic acc 0.845360824742268\n"]}]},{"cell_type":"code","source":["valid = mnli[\"validation_mismatched\"]\n","valid = [ex for ex in valid if overlaps(ex)]\n","acc = sum(int(ex[\"label\"] == ENTAILS) for ex in valid) / len(valid)\n","print(\"Heuristic acc\", acc)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"affiiiurwhm4","executionInfo":{"status":"ok","timestamp":1668391781089,"user_tz":300,"elapsed":8816,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"e2137236-4e54-4cb6-e0ea-2570ba144a36"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Heuristic acc 0.851063829787234\n"]}]},{"cell_type":"markdown","source":["MNLI models can still rely on the length heuristic to do very well on the validation set.\n","\n","Let's check ANLI, an even newer NLI dataset built adversarially."],"metadata":{"id":"PfHYNoEqwo6C"}},{"cell_type":"code","source":["anli = load_dataset(\"anli\")"],"metadata":{"id":"3VxnImKUwvxl"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["valid = anli[\"dev_r2\"]\n","valid = [ex for ex in valid if overlaps(ex)]\n","acc = sum(int(ex[\"label\"] == ENTAILS) for ex in valid) / len(valid)\n","print(\"Heuristic acc\", acc)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ZLTM-rc-w7hM","executionInfo":{"status":"ok","timestamp":1668391786613,"user_tz":300,"elapsed":301,"user":{"displayName":"William Merrill","userId":"00521682070879348599"}},"outputId":"72ad28e1-b580-4108-a010-5d23a0d1e420"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Heuristic acc 0.11764705882352941\n"]}]},{"cell_type":"markdown","source":["## Conclusion\n","\n","We saw two concerning things about evaluating language understanding with NLI:\n","\n","1. Hypothesis-only model works better than model with access to premise + hypothesis!\n","2. Lexical overlap heuristic (not causally valid) is extremely useful for SNLI/MNLI!\n","\n","Model can learn to pick up on these (and other heuristics) without reasoning about sentence meanings *at all*.\n","Hard to draw conclusions about model's language understanding capabilities from these NLI datasets.\n","Be skeptical of claims of language understanding in neural networks if the evaluation is based on NLI alone.\n","\n","## References\n","\n","* [*Right for the Wrong Reasons*: McCoy et al., 2019](https://aclanthology.org/P19-1334/)\n","* Natural Language Understanding course at NYU"],"metadata":{"id":"gx9TBuuuxRoX"}}],"metadata":{"accelerator":"GPU","colab":{"collapsed_sections":[],"provenance":[]},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"09a3e6f1da3a4786b2b8cc798b2afd8b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9cb83ad0995c4cebadc30eec4f224d5b","IPY_MODEL_fa8903919678492a944a96c613fb024c","IPY_MODEL_12454eee837b4395ac2bee2a5f5d17d4"],"layout":"IPY_MODEL_67130e527da9476db7621ec613ff29e7"}},"9cb83ad0995c4cebadc30eec4f224d5b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d392d54bcd91479dab8d99bcde9332ee","placeholder":"​","style":"IPY_MODEL_7539bc8b37be43068307a2cd066bc1c5","value":"100%"}},"fa8903919678492a944a96c613fb024c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_56cf01c787fa4fbeac1afd33186dd657","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_7d134b767ffa44e2b286f99a3206757c","value":3}},"12454eee837b4395ac2bee2a5f5d17d4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3a7ea45e85d14139998e832036a0073e","placeholder":"​","style":"IPY_MODEL_0c5ba4eda7834fc5b8e16deaa3ff40d5","value":" 3/3 [00:00&lt;00:00, 77.66it/s]"}},"67130e527da9476db7621ec613ff29e7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d392d54bcd91479dab8d99bcde9332ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7539bc8b37be43068307a2cd066bc1c5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"56cf01c787fa4fbeac1afd33186dd657":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7d134b767ffa44e2b286f99a3206757c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"3a7ea45e85d14139998e832036a0073e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0c5ba4eda7834fc5b8e16deaa3ff40d5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e7d6e905063147ab8de105995368cc19":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_602e4ab5458c417f9cdaa05e082e49d7","IPY_MODEL_9a1ae7c4369440f9ad70be63b788415a","IPY_MODEL_bc7742f3b2d84463b45c439578f35122"],"layout":"IPY_MODEL_c819dada8e514e6186669f14cf8d2b7c"}},"602e4ab5458c417f9cdaa05e082e49d7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9eb71cfc7b8b4795a08dd328c9b54aa8","placeholder":"​","style":"IPY_MODEL_08478f78fce9431fb3459fc57e8b97d9","value":"Downloading builder script: 100%"}},"9a1ae7c4369440f9ad70be63b788415a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7f639d82461d4033ad7b23811c076fd6","max":3821,"min":0,"orientation":"horizontal","style":"IPY_MODEL_90b5a102c8694c358b9285eb1704d545","value":3821}},"bc7742f3b2d84463b45c439578f35122":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ad88aab416ad40fa9b79501bbab7e5fc","placeholder":"​","style":"IPY_MODEL_2f276a57aede4b60b5b1f14180d85bd3","value":" 3.82k/3.82k [00:00&lt;00:00, 121kB/s]"}},"c819dada8e514e6186669f14cf8d2b7c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9eb71cfc7b8b4795a08dd328c9b54aa8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"08478f78fce9431fb3459fc57e8b97d9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7f639d82461d4033ad7b23811c076fd6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"90b5a102c8694c358b9285eb1704d545":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ad88aab416ad40fa9b79501bbab7e5fc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2f276a57aede4b60b5b1f14180d85bd3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"627a00139c434ccab765feff64e0b2fd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4496f75fd5794d9c966b41a85b00afc5","IPY_MODEL_b1973b69f2b542fa97a06d9f535ed49d","IPY_MODEL_87a969f0153d44bcb36ce4d59094da30"],"layout":"IPY_MODEL_874bffa442574437994e02f71d2ad1d6"}},"4496f75fd5794d9c966b41a85b00afc5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0825d735c71f438ab073080a5148eba0","placeholder":"​","style":"IPY_MODEL_5f3b383a93a84ba399ed7969c646b0f2","value":"Downloading metadata: 100%"}},"b1973b69f2b542fa97a06d9f535ed49d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9fc24641355d4ec88f637a4f3787a99e","max":1896,"min":0,"orientation":"horizontal","style":"IPY_MODEL_67198cd6cf1e4f93ab7daae8c98d4588","value":1896}},"87a969f0153d44bcb36ce4d59094da30":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2fb4b45d8eb8475aa3fe9868a6a98137","placeholder":"​","style":"IPY_MODEL_606f81a5a10a43f39f3e313c4bd0a966","value":" 1.90k/1.90k [00:00&lt;00:00, 62.4kB/s]"}},"874bffa442574437994e02f71d2ad1d6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0825d735c71f438ab073080a5148eba0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5f3b383a93a84ba399ed7969c646b0f2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9fc24641355d4ec88f637a4f3787a99e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"67198cd6cf1e4f93ab7daae8c98d4588":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"2fb4b45d8eb8475aa3fe9868a6a98137":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"606f81a5a10a43f39f3e313c4bd0a966":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d0710188920e422f84db1b84b5150aa9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0685dd5c76564aca8f57b38164784771","IPY_MODEL_8419867136d049789d65469a631ae2e5","IPY_MODEL_29674be589b94940853b25ba414116a4"],"layout":"IPY_MODEL_79e813ed753049f49b14882b9756a959"}},"0685dd5c76564aca8f57b38164784771":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_fa525f165a0341fcbef128dbb5759204","placeholder":"​","style":"IPY_MODEL_18233adbc9b146b6808c2eadb76d37c0","value":"Downloading readme: 100%"}},"8419867136d049789d65469a631ae2e5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_69a7b7e0ea314ec9aa99a86fc41185e2","max":14087,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b6b4978bb285418facf09bca38b822a9","value":14087}},"29674be589b94940853b25ba414116a4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a03c239db305429fb8d25bfbf28718ec","placeholder":"​","style":"IPY_MODEL_e317954cd3b24dcca331378e1896eaaf","value":" 14.1k/14.1k [00:00&lt;00:00, 18.6kB/s]"}},"79e813ed753049f49b14882b9756a959":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fa525f165a0341fcbef128dbb5759204":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18233adbc9b146b6808c2eadb76d37c0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"69a7b7e0ea314ec9aa99a86fc41185e2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b6b4978bb285418facf09bca38b822a9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a03c239db305429fb8d25bfbf28718ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e317954cd3b24dcca331378e1896eaaf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cbe0dd09aff04de28e41fbae0a8d825f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6e5ddcfebb4348b3ad4f070d1da40e68","IPY_MODEL_cbbaedc03c94411190a7f749df4809dd","IPY_MODEL_34d0f29afb7b49d799d1efe5ef0cd9e0"],"layout":"IPY_MODEL_2dbcb70a5a9b44d7bb4cdf437455187d"}},"6e5ddcfebb4348b3ad4f070d1da40e68":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_26f8dae7994f48d4a8bd87ba2121d2db","placeholder":"​","style":"IPY_MODEL_cf047eef42644c7da4f0300a653511b1","value":"Downloading: 100%"}},"cbbaedc03c94411190a7f749df4809dd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_8c6550a2c68a4b129d2c5029c4429a30","max":1929,"min":0,"orientation":"horizontal","style":"IPY_MODEL_af22e92f45864b088eeda5190e488cf0","value":1929}},"34d0f29afb7b49d799d1efe5ef0cd9e0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1bbd96b04a56492d823dde67e867f63d","placeholder":"​","style":"IPY_MODEL_6c9b19cc0bfa4355acdd45075376387f","value":" 1.93k/1.93k [00:00&lt;00:00, 62.0kB/s]"}},"2dbcb70a5a9b44d7bb4cdf437455187d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"26f8dae7994f48d4a8bd87ba2121d2db":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cf047eef42644c7da4f0300a653511b1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8c6550a2c68a4b129d2c5029c4429a30":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"af22e92f45864b088eeda5190e488cf0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1bbd96b04a56492d823dde67e867f63d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6c9b19cc0bfa4355acdd45075376387f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7058fe744d6a4dfc9e8a84281c46db69":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2bb0c0e16c754c6bb7b01117431bf81f","IPY_MODEL_afd14df3f27c40bd8a61779c3a3b190f","IPY_MODEL_b1f344b4ae3f48e1b0bd20cdf467daf4"],"layout":"IPY_MODEL_91e36393b88a47caa70a886c8a6d5a4f"}},"2bb0c0e16c754c6bb7b01117431bf81f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_34f514250f34474c97e0d226fcec9d5c","placeholder":"​","style":"IPY_MODEL_e36fb8977b9d41f995955a5846400a41","value":"Downloading: 100%"}},"afd14df3f27c40bd8a61779c3a3b190f":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0cf9d07899394c76a54f0c747e7c7ea5","max":1259440,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8fa19acaaa3c42638f19a87ad90d8df2","value":1259440}},"b1f344b4ae3f48e1b0bd20cdf467daf4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_1e065652779e43c683ffddcf6aa1d46d","placeholder":"​","style":"IPY_MODEL_779acdeca00e441182e73d88e77a8e76","value":" 1.26M/1.26M [00:00&lt;00:00, 15.2MB/s]"}},"91e36393b88a47caa70a886c8a6d5a4f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"34f514250f34474c97e0d226fcec9d5c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e36fb8977b9d41f995955a5846400a41":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0cf9d07899394c76a54f0c747e7c7ea5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8fa19acaaa3c42638f19a87ad90d8df2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"1e065652779e43c683ffddcf6aa1d46d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"779acdeca00e441182e73d88e77a8e76":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"137c5d836c95443f80ec5c61d63bc9bf":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_498418489f0b4d20981e57db0d499e8f","IPY_MODEL_4e016f232d3e4a90ac43102d383c565d","IPY_MODEL_f758ecafa39740d1a7d09421e3e1b29a"],"layout":"IPY_MODEL_768b0123b43d4a91b65c0bec82cd0ee5"}},"498418489f0b4d20981e57db0d499e8f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_28a99bcb17fc44b1a19d7f1f10f33b04","placeholder":"​","style":"IPY_MODEL_e48b302d5c3b41f6ba3c3e2eed67b8a2","value":"Downloading: 100%"}},"4e016f232d3e4a90ac43102d383c565d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_a5ed5533b64848f590860c4a23c45d72","max":65886400,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2572b42a0f9546aa9026fccfad3dc5e2","value":65886400}},"f758ecafa39740d1a7d09421e3e1b29a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_af706bc0fde54ed9ae91edb1459fd92b","placeholder":"​","style":"IPY_MODEL_788a447afa8048c7a80c852e8128648a","value":" 65.9M/65.9M [00:06&lt;00:00, 12.3MB/s]"}},"768b0123b43d4a91b65c0bec82cd0ee5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"28a99bcb17fc44b1a19d7f1f10f33b04":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e48b302d5c3b41f6ba3c3e2eed67b8a2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a5ed5533b64848f590860c4a23c45d72":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2572b42a0f9546aa9026fccfad3dc5e2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"af706bc0fde54ed9ae91edb1459fd92b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"788a447afa8048c7a80c852e8128648a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bab8d47cbb3a4c1d96290e2ca3ed1af2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0db124207598418a99894647fc8cfda2","IPY_MODEL_f3548b0dbaad41d797fb3e43ab95ab18","IPY_MODEL_1234ae1fc2984796b1105b7356007c91"],"layout":"IPY_MODEL_c9367b9997454afd87eb7ebcdcac7217"}},"0db124207598418a99894647fc8cfda2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2ba2ab735e4544a0b2ee1f05f26ce006","placeholder":"​","style":"IPY_MODEL_411f0863065b4f53a54595fbef9dfba2","value":"Downloading: 100%"}},"f3548b0dbaad41d797fb3e43ab95ab18":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_1bf9b63540fd444ba7d5937e672159da","max":1263568,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f40801fcaefd4a3881f518195ae7a19c","value":1263568}},"1234ae1fc2984796b1105b7356007c91":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ca72e87db3e54bd9b73e1879628bd8e0","placeholder":"​","style":"IPY_MODEL_ae05f174c13e4ffeb200a6394301a016","value":" 1.26M/1.26M [00:00&lt;00:00, 15.5MB/s]"}},"c9367b9997454afd87eb7ebcdcac7217":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2ba2ab735e4544a0b2ee1f05f26ce006":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"411f0863065b4f53a54595fbef9dfba2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1bf9b63540fd444ba7d5937e672159da":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f40801fcaefd4a3881f518195ae7a19c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ca72e87db3e54bd9b73e1879628bd8e0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ae05f174c13e4ffeb200a6394301a016":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"949459b7558d485eb0a438b68343270b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6cd109a57bc14f2e98149ab611082e75","IPY_MODEL_7e20909993964beab973beceef8ccfa1","IPY_MODEL_b5e25ebe26bc46609923021db0719c0b"],"layout":"IPY_MODEL_58bb420f8ece412e9816eacfcae1f547"}},"6cd109a57bc14f2e98149ab611082e75":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_14e593a62d164a50b46629e40f21a414","placeholder":"​","style":"IPY_MODEL_4d7e56abaec74acfabb170ef17dfefa0","value":"100%"}},"7e20909993964beab973beceef8ccfa1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6c0528a25967427c86767a59e4fa8d5f","max":3,"min":0,"orientation":"horizontal","style":"IPY_MODEL_9aaeee00ed2f463abb61f85e246bef9f","value":3}},"b5e25ebe26bc46609923021db0719c0b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cfc170529cac4d889ca55537b5044fa9","placeholder":"​","style":"IPY_MODEL_e0c0d580a457439089f3b7f4e9952950","value":" 3/3 [00:00&lt;00:00, 53.19it/s]"}},"58bb420f8ece412e9816eacfcae1f547":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"14e593a62d164a50b46629e40f21a414":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4d7e56abaec74acfabb170ef17dfefa0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6c0528a25967427c86767a59e4fa8d5f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9aaeee00ed2f463abb61f85e246bef9f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"cfc170529cac4d889ca55537b5044fa9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e0c0d580a457439089f3b7f4e9952950":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bf456cf4973343ffab191a731ee0c5c8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_bfd910fa7a154fa0a5d8fb29b68109aa","IPY_MODEL_8f8d08171d054af6aa68701805e39b54","IPY_MODEL_f289d11f96a341a6bdc69ce56b33e3d2"],"layout":"IPY_MODEL_0c51f768701c4d189ca9b60da1298ded"}},"bfd910fa7a154fa0a5d8fb29b68109aa":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a345238699484b90ac54fd3cebaf3e9b","placeholder":"​","style":"IPY_MODEL_a3fd7bd087be498d9d5c94f0f1476eb6","value":"Downloading: 100%"}},"8f8d08171d054af6aa68701805e39b54":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b4e094e04d7348fcab0b8d4cc1b78484","max":231508,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b79313c14b90436581c6a5ad0878ed2b","value":231508}},"f289d11f96a341a6bdc69ce56b33e3d2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6b115376a60843919ea098fab63aaebb","placeholder":"​","style":"IPY_MODEL_ecc252b5030040259b7909f74297b002","value":" 232k/232k [00:00&lt;00:00, 279kB/s]"}},"0c51f768701c4d189ca9b60da1298ded":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a345238699484b90ac54fd3cebaf3e9b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a3fd7bd087be498d9d5c94f0f1476eb6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b4e094e04d7348fcab0b8d4cc1b78484":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b79313c14b90436581c6a5ad0878ed2b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"6b115376a60843919ea098fab63aaebb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ecc252b5030040259b7909f74297b002":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"df64f79946ab449b9618b8954ca7f2a5":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_96416c064a064e1593c0f4dfafbf3bee","IPY_MODEL_cb7f240641e54d968be2830a921a4bf8","IPY_MODEL_fbde5b5fdd6542449aabeaea8c5d3fc9"],"layout":"IPY_MODEL_91ee86a2447842d8adb7afcbe2b62a01"}},"96416c064a064e1593c0f4dfafbf3bee":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d8c5f9ce5f2849a5a3658c67681a0b84","placeholder":"​","style":"IPY_MODEL_bb5d6e7786bc4d7196d53443d8645a5c","value":"Downloading: 100%"}},"cb7f240641e54d968be2830a921a4bf8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_aaaea15b520a4c009509ff0d8a748afa","max":28,"min":0,"orientation":"horizontal","style":"IPY_MODEL_46598f73e0c24516aaeac05862893099","value":28}},"fbde5b5fdd6542449aabeaea8c5d3fc9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f10b962d23f8400bbfb2d09ea3604421","placeholder":"​","style":"IPY_MODEL_23e023296dc1409e9b1d6acd468298c5","value":" 28.0/28.0 [00:00&lt;00:00, 990B/s]"}},"91ee86a2447842d8adb7afcbe2b62a01":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d8c5f9ce5f2849a5a3658c67681a0b84":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bb5d6e7786bc4d7196d53443d8645a5c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"aaaea15b520a4c009509ff0d8a748afa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"46598f73e0c24516aaeac05862893099":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f10b962d23f8400bbfb2d09ea3604421":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"23e023296dc1409e9b1d6acd468298c5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1d7bea5db7e84a8ba04ade331c2e2401":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ba19c947302a43378108268bd4c29931","IPY_MODEL_35f859eaad66428eae2e24cb96ced7d4","IPY_MODEL_2a6856a01f8b4cceaa6c5ab4ffefe823"],"layout":"IPY_MODEL_72a4177be5304b5ba7eaec8d9ef2f6fb"}},"ba19c947302a43378108268bd4c29931":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7c908619b17c4ff0b68fb3f9a8b79a99","placeholder":"​","style":"IPY_MODEL_b23a29a1518840928c29455d282abad3","value":"Downloading: 100%"}},"35f859eaad66428eae2e24cb96ced7d4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_23dabbb566944341a03a1268a901e5b0","max":483,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f97ff31cb55d498aaad8c5ded2167c55","value":483}},"2a6856a01f8b4cceaa6c5ab4ffefe823":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4a08de7859e44b5da463ea70e8f7db8f","placeholder":"​","style":"IPY_MODEL_c731e734451f4b47bd23405dfa4a23a6","value":" 483/483 [00:00&lt;00:00, 14.9kB/s]"}},"72a4177be5304b5ba7eaec8d9ef2f6fb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7c908619b17c4ff0b68fb3f9a8b79a99":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b23a29a1518840928c29455d282abad3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"23dabbb566944341a03a1268a901e5b0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f97ff31cb55d498aaad8c5ded2167c55":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4a08de7859e44b5da463ea70e8f7db8f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c731e734451f4b47bd23405dfa4a23a6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d7b102d97a894b9dbe036bca4949a292":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_37669661554a4a0ca1bafcfef3840c56","IPY_MODEL_e64205ec2ed741ec92040bc47715d29a","IPY_MODEL_2117f4b511e8462d8c8b4ec0718044cd"],"layout":"IPY_MODEL_c093b28357ac4f5997c8a240069541f4"}},"37669661554a4a0ca1bafcfef3840c56":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3f6f60d94c2f47c8bd732995430b52a2","placeholder":"​","style":"IPY_MODEL_945f01a5114f4deebb7cb9d3220a2f7a","value":"Downloading: 100%"}},"e64205ec2ed741ec92040bc47715d29a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6125d2c58b784b39bed36c657674ab3a","max":267967963,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a83005ff5c0a4e78a7b0afcf0613733a","value":267967963}},"2117f4b511e8462d8c8b4ec0718044cd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0eeaf77ac1604549ac44e74b7981f1c4","placeholder":"​","style":"IPY_MODEL_bfdad0a750b64189b841f6ae5bc7441b","value":" 268M/268M [00:04&lt;00:00, 55.9MB/s]"}},"c093b28357ac4f5997c8a240069541f4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3f6f60d94c2f47c8bd732995430b52a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"945f01a5114f4deebb7cb9d3220a2f7a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6125d2c58b784b39bed36c657674ab3a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a83005ff5c0a4e78a7b0afcf0613733a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0eeaf77ac1604549ac44e74b7981f1c4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bfdad0a750b64189b841f6ae5bc7441b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}